<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>jgomezdans</title><link href="/" rel="alternate"></link><link href="//feeds/all.atom.xml" rel="self"></link><id>/</id><updated>2012-07-20T13:00:00+01:00</updated><entry><title>Linearly scaling raster data with GDAL</title><link href="//linearly-scaling-raster-data-with-gdal.html" rel="alternate"></link><updated>2012-07-20T13:00:00+01:00</updated><author><name>J Gómez-Dans</name></author><id>//linearly-scaling-raster-data-with-gdal.html</id><summary type="html">&lt;p&gt;So, it's quite tricky to play around with these geospatial datasets: they
have a myriad formats, these keep changing, and you can never know what
metadata will be available in them. A clever way around this situation
is to use tools that allow you to read most of the data, most of the
associated metadata, and that let you do the usual minor tweaks that
you'll require to get things working. And this means GDAL (for rasters)
and OGR (for vectors).&lt;/p&gt;
&lt;p&gt;Typical problem: you get some data you've never seen before, and it is
linearly scaled (so they put it in as a 16bit integer and you need to
apply a linear mapping to get the units right as floating point numbers).
In the GDAL mailing list &lt;a class="reference external" href="http://lists.osgeo.org/pipermail/gdal-dev/2012-July/033504.html"&gt;there's a thread on this&lt;/a&gt;
using the MODIS SST product. Obviously, you need a reasonable file format
that is read easily (this mean GeoTIFF), and you need it in the right
units, as you don't want to remember these things. The easiest way to
accomplish this is to use &lt;tt class="docutils literal"&gt;gdal_translate&lt;/tt&gt;, with its rather handy
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-scale&lt;/span&gt; option&lt;/tt&gt;, which performs a linear scaling. We'll also want to
change the data type to a floating point number, as otherwise results
will be quantised. From the post above, we know what the linear scaling
is, but we need to convert it to GDAL, which requires a mapping from
source minimum and maximum values to destimation min/max. One way to
do this is to assume that the data span the complete range between
0 and 65534 (maximum possible number) and calculate the two extrema
in the destination space if you know the slope and intercept. Another
way is to fish those two destination numbers from the metadata. Using&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gdalinfo A20030012003008.L3m_8D_NSST_4
[...]
Scaling=linear
Scaling Equation=(Slope*l3m_data) + Intercept = Parameter value
Slope=0.000717185
Intercept=-2
Scaled Data Minimum=-2
Scaled Data Maximum=45
Data Minimum=-1.999999
Data Maximum=35.785
[...]
&lt;/pre&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;we see that the total scaling is between -2 and 45. A bash script that&lt;/dt&gt;
&lt;dd&gt;loops over a set of files could be&lt;/dd&gt;
&lt;/dl&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;for &lt;/span&gt;file in A*L3m_8D_NSST_4 ;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="k"&gt;  &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;map: $file&amp;quot;&lt;/span&gt;
  gdal_translate -of GTiff -ot Float32 &lt;span class="se"&gt;\&lt;/span&gt;
                      -scale 0 65534 -2. 45. &lt;span class="se"&gt;\&lt;/span&gt;
                      -a_srs &lt;span class="s2"&gt;&amp;quot;EPSG:4326&amp;quot;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
                      -a_nodata 65535  &lt;span class="se"&gt;\&lt;/span&gt;
                      -a_ullr -180 90 180 -90 &lt;span class="se"&gt;\&lt;/span&gt;
                      -co &lt;span class="s2"&gt;&amp;quot;COMPRESS=PACKBITS&amp;quot;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
                      &lt;span class="s1"&gt;&amp;#39;HDF4_SDS:UNKNOWN:&amp;quot;A20030012003008.L3m_8D_NSST_4&amp;quot;:0&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
                      A20030012003008.L3m_8D_NSST_4.tif
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A further refinement to save space is to convert the data to a
&lt;a class="reference external" href="http://www.gdal.org/gdal_vrttut.html"&gt;GDAL Virtual Raster&lt;/a&gt;. This
is basically a pointer to the datafile in the form of an XML file. If
you only access the files rarely, or if you plan to carry out more processing
on them, then this saves you storing more copies of the same data&lt;/p&gt;
&lt;pre class="literal-block"&gt;
gdal_translate -of VRT -ot Float32 -scale 0 65534 -2. 45. \
    -a_srs &amp;quot;EPSG:4326&amp;quot; -a_nodata 65535  \
    -a_ullr -180 90 180 -90 -co &amp;quot;COMPRESS=PACKBITS&amp;quot; \
    'HDF4_SDS:UNKNOWN:&amp;quot;A20030012003008.L3m_8D_NSST_4&amp;quot;:0' \
    A20030012003008.L3m_8D_NSST_4.vrt
&lt;/pre&gt;
&lt;p&gt;results in the following VRT file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;VRTDataset&lt;/span&gt; &lt;span class="na"&gt;rasterXSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8640&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;rasterYSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;4320&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;SRS&amp;gt;&lt;/span&gt;GEOGCS[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;WGS 84&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,DATUM[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;WGS_1984&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,SPHEROID[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;WGS 84&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,6378137,298.257223563,AUTHORITY[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;EPSG&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;7030&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;]],AUTHORITY[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;EPSG&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;6326&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;]],PRIMEM[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;Greenwich&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,0,AUTHORITY[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;EPSG&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;8901&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;]],UNIT[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;degree&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,0.0174532925199433,AUTHORITY[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;EPSG&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;9122&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;]],AUTHORITY[&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;EPSG&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;4326&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;]]&lt;span class="nt"&gt;&amp;lt;/SRS&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;GeoTransform&amp;gt;&lt;/span&gt; -1.8000000000000000e+02,  4.1666666666666664e-02,  0.0000000000000000e+00,  9.0000000000000000e+01,  0.0000000000000000e+00, -4.1666666666666664e-02&lt;span class="nt"&gt;&amp;lt;/GeoTransform&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;Metadata&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Product Name&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;A20030012003008.L3m_8D_NSST_4&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Sensor Name&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;MODISA&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Sensor&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Title&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;MODISA Level-3 Standard Mapped Image&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Data Center&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Station Name&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Station Latitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Station Longitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Mission&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Mission Characteristics&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Sensor Characteristics&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Product Type&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;8-day&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Replacement Flag&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;ORIGINAL&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Software Name&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;smigen&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Software Version&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;3.30&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Processing Time&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2006060201827000&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Input Files&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;A20030012003008.L3b_8D_NSST.main&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Processing Control&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;smigen par=A20030012003008.L3m_8D_NSST_4.param&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Input Parameters&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;IFILE = /data1/vdc/sdpsoper/vpu0/workbuf/A20030012003008.L3b_8D_NSST.main|OFILE = A20030012003008.L3m_8D_NSST_4|PFILE = |PROD = sst|PALFILE = DEFAULT|RFLAG = ORIGINAL|MEAS = 1|STYPE = 0|DATAMIN = 0.000000|DATAMAX = 0.000000|LONWEST = -180.000000|LONEAST = 180.000000|LATSOUTH = -90.000000|LATNORTH = 90.000000|RESOLUTION = 4km|PROJECTION = RECT|GAP_FILL = 0|SEAM_LON = -180.000000|PRECISION = |&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;L2 Flag Names&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;LAND,~HISOLZ&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Period Start Year&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2003&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Period Start Day&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;1&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Period End Year&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2003&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Period End Day&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;8&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Start Time&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2002365123005000&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;End Time&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2003009023005000&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Start Year&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2002&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Start Day&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;365&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Start Millisec&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;45005000&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;End Year&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;2003&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;End Day&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;9&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;End Millisec&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;9005000&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Start Orbit&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;End Orbit&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Orbit&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Map Projection&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Equidistant Cylindrical&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Latitude Units&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;degrees North&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Longitude Units&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;degrees East&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Northernmost Latitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;90&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Southernmost Latitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-90&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Westernmost Longitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-180&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Easternmost Longitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;180&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Latitude Step&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0.04166667&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Longitude Step&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0.04166667&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;/MDI
        &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SW Point Latitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-89.97916&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;SW Point Longitude&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-179.9792&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Data Bins&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;13045202&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Number of Lines&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;4320&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Number of Columns&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;8640&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Parameter&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Sea Surface Temperature&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Measure&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;Mean&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Units&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;deg-C&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Scaling&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;linear&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Scaling Equation&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;(Slope*l3m_data) + Intercept = Parameter value&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Slope&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0.000717185&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Intercept&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-2&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Scaled Data Minimum&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-2&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Scaled Data Maximum&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;45&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Data Minimum&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-1.999999&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Data Maximum&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;35.785&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Scaling&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;linear&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Scaling Equation&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;(Slope*l3m_data) + Intercept = Parameter value&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Slope&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;0.000717185&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;MDI&lt;/span&gt; &lt;span class="na"&gt;key=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Intercept&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;-2&lt;span class="nt"&gt;&amp;lt;/MDI&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/Metadata&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;VRTRasterBand&lt;/span&gt; &lt;span class="na"&gt;dataType=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Float32&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;band=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;Metadata&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;NoDataValue&amp;gt;&lt;/span&gt;6.55350000000000E+04&lt;span class="nt"&gt;&amp;lt;/NoDataValue&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;ColorInterp&amp;gt;&lt;/span&gt;Gray&lt;span class="nt"&gt;&amp;lt;/ColorInterp&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;ComplexSource&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;SourceFilename&lt;/span&gt; &lt;span class="na"&gt;relativeToVRT=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;HDF4_SDS:UNKNOWN:&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;A20030012003008.L3m_8D_NSST_4&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;:0&lt;span class="nt"&gt;&amp;lt;/SourceFilename&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;SourceBand&amp;gt;&lt;/span&gt;1&lt;span class="nt"&gt;&amp;lt;/SourceBand&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;SourceProperties&lt;/span&gt; &lt;span class="na"&gt;RasterXSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8640&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;RasterYSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;4320&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;DataType=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;UInt16&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;BlockXSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8640&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;BlockYSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;115&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;SrcRect&lt;/span&gt; &lt;span class="na"&gt;xOff=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;yOff=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;xSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8640&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;ySize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;4320&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;DstRect&lt;/span&gt; &lt;span class="na"&gt;xOff=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;yOff=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;xSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;8640&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;ySize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;4320&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;ScaleOffset&amp;gt;&lt;/span&gt;-2&lt;span class="nt"&gt;&amp;lt;/ScaleOffset&amp;gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&amp;lt;ScaleRatio&amp;gt;&lt;/span&gt;0.000717185&lt;span class="nt"&gt;&amp;lt;/ScaleRatio&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;/ComplexSource&amp;gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&amp;lt;/VRTRasterBand&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/VRTDataset&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It basically points to the original data, and has the scaling information.
If you wanted to, you could also use the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-projwin&lt;/span&gt;&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-srcwin&lt;/span&gt;&lt;/tt&gt;
options to crop the data, or even reproject it with &lt;tt class="docutils literal"&gt;gdalwarp&lt;/tt&gt;.&lt;/p&gt;
</summary><category term="GDAL"></category><category term="remote sensing"></category></entry><entry><title>EOLDAS out in the wild!</title><link href="//eoldas-out-in-the-wild.html" rel="alternate"></link><updated>2012-07-18T15:00:00+01:00</updated><author><name>J Gómez-Dans</name></author><id>//eoldas-out-in-the-wild.html</id><summary type="html">&lt;p&gt;After quite some time, we have released the EOLDAS software. The
EOLDAS software is a prototype &lt;a class="reference external" href="http://en.wikipedia.org/wiki/Data_assimilation"&gt;data assimilation&lt;/a&gt; framework for the land
surface, although it is quite generic, and can be used for typical variational
problems, with a weak or a strong constraint.&lt;/p&gt;
&lt;p&gt;Currently, we are using a radiative transfer code as an observation
operator, and imposing weak constraints in land surface state components,
rather than a fully-fledged dynamic vegetation model, for example. This
dynamic model merely states that the state today is the same as yesterday,
but with some uncertainty. This is implemented as a differential operator,
and is the idea behind Tikhonov regularisation.&lt;/p&gt;
&lt;p&gt;A first approach would assume that
each individual measurement in contaminated by independent Gaussian noise with
a variance $\sigma^{2}_{obs}$. Stacking the uncertainties into a
covariance
matrix $C_{obs}$, we can write the contribution of the observation
mismatch
to our problem as $J_{obs}$:
[
J_{obs} = (1/2) (\mathbf{y_{obs}} - H(\mathbf{x}))^{T} (\mathbf{C_{obs}}^{-1}+\mathbf{C_{H}}^{-1}) (\mathbf{y_{obs}} -H(mathbf{x} )),
]&lt;/p&gt;
&lt;p&gt;[&lt;/p&gt;
&lt;p&gt;\left(\begin{matrix} a &amp;amp; b \\
c &amp;amp; d \end{matrix}\right)&lt;/p&gt;
&lt;p&gt;]&lt;/p&gt;
&lt;p&gt;[
\mathbf{\Delta} =
\begin{pmatrix}
1      &amp;amp; -1     &amp;amp;  0     &amp;amp; \cdots &amp;amp; 0\\
0      &amp;amp; 1      &amp;amp; -1     &amp;amp; \cdots &amp;amp; 0\\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; \ddots &amp;amp; 0\\
0      &amp;amp; 0      &amp;amp; 0      &amp;amp; \cdots &amp;amp; -1\\
\end{pmatrix}
]&lt;/p&gt;
&lt;p&gt;Stacking again the variances into a a covariance matrix, we can now define
$J_{smooth}$ as
[
J_{smooth} = (1/2)  \gamma^{2} (\mathbf{\Delta x})^{T}\mathbf{C_{smooth}}^{-1}(\mathbf{\Delta x)}.
]&lt;/p&gt;
</summary><category term="remote sensing"></category><category term="data assimilation"></category></entry></feed>